import { useI18n } from '@scaleway/use-i18n'
import { ArgsTable, Canvas, Meta, Story } from '@storybook/addon-docs'
import { es, fr, ru } from 'date-fns/locale'
import DateInput from '..'
import ControlValue from '../../../__stories__/components/ControlValue'
import Box from '../../Box'
import RichSelect from '../../RichSelect'

<Meta title="Components/Data Entry/DateInput" />

# DateInput

A date input based on `react-datepicker`.

<Canvas>
  <Story name="Basic" height="360px">
    <DateInput label="Date" />
  </Story>
</Canvas>

## Uncontrolled

DateInput can be used as an [uncontrolled component](https://reactjs.org/docs/uncontrolled-components.html).

<Canvas>
  <Story name="Uncontrolled" height="360px">
    <DateInput label="Date" />
  </Story>
</Canvas>

## Controlled

Most of the time, you need a [controlled component](https://reactjs.org/docs/forms.html#controlled-components). By passing `value` and `onChange` prop you can control it.

<Canvas>
  <Story name="Controlled" height="360px">
    <ControlValue value={new Date('December 17, 1995 03:24:00')}>
      {({ value, onChange }) => (
        <DateInput label="Date" value={value} onChange={onChange} />
      )}
    </ControlValue>
  </Story>
</Canvas>

## Error

Use `error` prop to style the input when the field is invalid.

<Canvas>
  <Story name="Error" height="380px">
    <DateInput label="Error" error="This is an error" />
  </Story>
</Canvas>

## Disabled

<Canvas>
  <Story name="Disabled">
    <DateInput label="Disabled" disabled />
  </Story>
</Canvas>

## Required

<Canvas>
  <Story name="Required" height="360px">
    <DateInput label="Required" required />
  </Story>
</Canvas>

## Localized

You can import locale from `date-fns/locale` package and pass it as `locale` prop to localize the input.

<Canvas>
  <Story name="Localized" height="360px">
    <Box mb={2}>
      <DateInput label="fr-FR" locale={fr} />
    </Box>
    <Box mb={2}>
      <DateInput label="es-ES" locale={es} />
    </Box>
    <DateInput label="ru-RU" locale={ru} />
  </Story>
</Canvas>

## Example with i18n Provider

If you use our `useI18n` hook you can easily handle localization change on the input by getting `currentLocale` returned by the hook.

<Canvas>
  <Story name="i18n provider" height="360px">
    {() => {
      const { locales, currentLocale, switchLocale, dateFnsLocale } = useI18n()
      return (
        <>
          <RichSelect
            name="locale-switcher"
            isSearchable={false}
            value={{
              label: currentLocale,
              value: currentLocale,
            }}
            onChange={({ value }) => switchLocale(value)}
            noTopLabel
            mb={3}
          >
            {locales.map(locale => (
              <RichSelect.Option value={locale} key={locale}>
                {locale}
              </RichSelect.Option>
            ))}
          </RichSelect>
          <DateInput label={currentLocale} locale={dateFnsLocale} />
        </>
      )
    }}
  </Story>
</Canvas>

## Min Max

With `minDate` and `maxDate` you can define limits of the input

<Canvas>
  <Story name="Min-Max" height="360px">
    <DateInput
      label="Date"
      value={new Date('1995-12-17T03:24:00')}
      minDate={new Date('December 12, 1995 03:24:00')}
      maxDate={new Date('December 25, 1995 03:24:00')}
    />
  </Story>
</Canvas>

## API

<ArgsTable of={DateInput} />
